---
date of creation: 2024-07-15T13:49:00
tags:
  - HTML5
  - HTML
  - Web
  - Web/HTML
  - IT
  - IT/HTML
  - Audio
  - Video
  - Formats
read status: true
aliases:
  - Видео и аудио в HTML5
---
---
# Аудио и видео в HTML5


Одним из самых мощных стимулов возрастания роли интернета стал постоянно увеличивающийся спрос со стороны пользователей на повышение доли мультимедийного содержимого в форме аудио- и видеоконтента. Поначалу высокая пропускная способность обходилась настолько дорого, что организовывать такие вещи, как живой поток, не представлялось возможным, а загрузка звуковой дорожки, не говоря уже о видео, могла продолжаться несколько минут или даже часов.

Высокая стоимость трафика и ограниченная доступность высокоскоростных модемов стимулировали разработку более быстродействующих и эффективных алгоритмов сжатия, таких как [[MP3|MP3-аудио]] и [[MPEG|MPEG-видео]], но даже при этом единственный способ загрузки файлов за разумное количество времени был связан с резким ухудшением их качества.

Один из моих ранних интернет-проектов в далеком 1997 году представлял собой первую в Великобритании онлайн-радиостанцию, лицензированную музыкальными полномочными органами. Фактически это, скорее всего, был подкаст (еще до того, как этот термин был придуман), поскольку там создавалось ежедневное получасовое шоу, которое затем сжималось до 8-разрядного моносигнала с полосой пропускания 11 кГц с помощью алгоритма, первоначально разработанного для телефонии. При этом звучание было телефонного качества или еще хуже. И все же мы быстро собрали тысячи слушателей, загружавших шоу и затем прослушивающих его по мере обхода обсуждаемых сайтов с использованием всплывающего окна браузера, содержащего дополнительный модуль.

К счастью для нас и для всех, кто публиковал мультимедиа, вскоре появилась возможность предложить более высокое качество аудио и видео, но по-прежнему только путем обращения к пользователю с просьбой загрузить и установить дополнительный модуль проигрывателя. Наиболее популярным из этих проигрывателей после победы над соперниками, например над RealAudio, стал Flash, но он получил неважную репутацию по причине множественных сбоев браузера и постоянных требований обновления при выпуске новых версий.

Поэтому все согласились с тем, что в перспективе нужны веб-стандарты для поддержки мультимедиа непосредственно в браузере. Разумеется, такие разработчики браузеров, как Microsoft и Google, имели различное видение того, как должны выглядеть эти стандарты, но когда пыль улеглась, они пришли к согласию по поводу поднабора типов файлов, которые должны изначально воспроизводиться на всех браузерах, и этот поднабор был введен в спецификацию HTML5.

И наконец, теперь появилась возможность (если аудио и видео кодируются в нескольких различных форматах) выкладывать мультимедиа на веб-сервер, указывать пару HTML-тегов в веб-странице и проигрывать медиа в любом из основных браузеров для настольных компьютеров, смартфонов или планшетных устройств, не заставляя при этом пользователя загружать дополнительный модуль или вносить какие-либо другие изменения.


## О кодеках
---

==*[[Видео-кодек]]* представляет собой кодировщик-*декодировщик*.== Им описывается функциональная возможность, предоставляемая программным обеспечением, занимающимся кодированием и декодированием такого медиа, как аудио и видео. В HTML5 имеется несколько различных наборов доступных кодеков, состав которых зависит от используемого браузера.

Применение аудио и видео связано с одним осложнением, которое редко применяется к графике и другому традиционному веб-контенту. Имеется в виду лицензирование, осуществляемое в отношении форматов и кодеков. Многие из этих форматов и кодеков предоставляются за определенную плату, поскольку они были разработаны какой-либо компанией или консорциумом компаний, которые выбрали вариант получения лицензионных отчислений. Некоторые бесплатные браузеры с открытым исходным кодом не поддерживают самые популярные форматы и кодеки, потому что их использование невозможно оплатить или потому что разработчики в принципе не согласны с лицензионными отчислениями. Поскольку законы об авторском праве варьируются от страны к стране и соблюдение лицензионных прав трудно обеспечить, кодеки обычно можно найти в интернете без каких-либо затрат, но их использование в месте вашего проживания может быть технически незаконным.

HTML5-тегом **`<audio>`** поддерживаются следующие кодеки (в том числе и когда аудио прикреплено к HTML5-видео).

- **AAC**. Этот аудиокодек, чье название означает Advanced Audio Encoding, является запатентованной технологией, которая обычно использует расширение `.aac` для файлов. Его MIME-типом является `audio/aac`.
- **FLAC**. Этот аудиокодек, название которого означает Free Lossless Audio Codec, был разработан фондом `Xiph.Org`. Он использует файловое расширение `.flac`, и его MIME-типом является `audio/flac`.
- **MP3**. Этот аудиокодек, название которого означает MPEG Audio Layer 3, доступен уже многие годы. Хотя это понятие зачастую (и неправильно) применяется для ссылки на любой тип цифрового аудио, оно относится к частной запатентованной технологии, которая использует расширение `.mp3`. [[MIME-типы (MIME-types)|MIME-типом]] является `audio/mpeg`.
- **PCM**. Этот аудиокодек, название которого означает Pulse Coded Modulation, сохраняет полноценные данные, закодированные аналого-цифровым преобразователем, и относится к формату, используемому для хранения данных на аудио-компакт-дисках. Поскольку сжатие в нем не используется, он называется кодеком без потерь и его файлы, как правило, во много раз больше, чем файлы [[AAC (Кодек)|AAC]] или [[MP3]]. Обычно файлы этого типа имеют расширение `.wav`. MIME-типом является `audio/wav`, но может встретиться и тип `audio/wave`.
- **Vorbis**. Иногда называется Ogg Vorbis, поскольку для файлов, как правило, используется расширение `.ogg`. Этот аудиокодек не обременен патентами и свободен от выплаты роялти. Его MIME-типом является `audio/ogg`, а для контейнера `WebM` используется `audio/webm`.

К середине 2021 года форматы AAC, MP3, PCM и Vorbis поддерживаются большинством операционных систем и браузеров (не включая снятый с производства Internet Explorer компании Microsoft), есть лишь несколько исключений, связанных с Safari.

- Vorbis audio/ogg. Для MacOS 10.11 и более ранних версий Safari требуется Xiph Quicktime.
- Vorbis audio/webm. Не поддерживается в Safari.
- FLAC audio/ogg. Не поддерживается в Safari (хотя аудио/flac поддерживается).

Следовательно, если у вас нет весомых причин использовать Vorbis, в настоящее время лучше использовать AAC либо MP3 для сжатого аудио с потерями, FLAC для сжатого аудио без потерь или PCM для несжатого аудио.


## Элемент **`<audio>`**
---

Чтобы угодить различным платформам, нужно записать или преобразовать содержимое с использованием нескольких кодеков, а затем перечислить их в тегах **`<audio>`** и **`</audio>`** как в **примере 27.1.** Вложенные теги **`<source>`** содержат различные медиа, которые вы желаете предложить браузеру. Благодаря предоставлению атрибута **`controls`** результат выглядит так, как показано на **рис. 27.1**.

В данный пример я включил три различных типа аудио, потому что это вполне приемлемо и может пригодиться, если нужно обеспечить, чтобы каждый браузер смог найти предпочтительный для себя формат, а не только один из форматов, который он в состоянии обработать. Но можно быть уверенным, что пример все равно будет проигрываться на всех платформах, если из него выбросить один из файлов: либо MP3, либо AAC (но не оба сразу).

>**Пример 27.1.** Встраивание трех различных типов аудиофайлов
```html
<!DOCTYPE html>
<html>
  <head>
    <title>Playing Audio</title>
  </head>
  <body><br><pre>
    <audio controls>
      <source src='audio.m4a' type='audio/aac'>
      <source src='audio.mp3' type='audio/mp3'>
      <source src='audio.ogg' type='audio/ogg'>
    </audio>
  </body>
</html>
```
>![[Рис. 27.1. Проигрывание аудиофайла.jpg]]
>**Рис. 27.1.** Проигрывание аудиофайла

Элемент **`<audio>`** и его партнер тег **`<source>`** поддерживают несколько атрибутов, в числе которых:

- **`autoplay`** — заставляет аудио запускаться на проигрывание сразу по готовности;
- **`controls`** — заставляет вывести панель управления;
- **`loop`** — устанавливает аудио на бесконечное проигрывание;
- **`preload`** — заставляет аудио приступить к загрузке даже до того, как пользователь выберет команду Play (Воспроизвести);
- **`src`** — указывает исходное местоположение аудиофайла;
- **`type`** — указывает кодек, используемый для создания аудио.

Если тег **`<audio>`** не снабдить атрибутом **`controls`**, а также не воспользоваться атрибутом **`autoplay`**, звук проигрываться не будет, а также не будет кнопки **Play** (Воспроизвести), которую можно было бы нажать для начала воспроизведения. Это не оставит вам никаких других вариантов, кроме как предложить эти функциональные возможности в JavaScript, как показано в **примере 25.2** (с необходимым дополнительным кодом, выделенным полужирным шрифтом). У вас появится возможность проигрывать аудио и ставить его на паузу, как показано на **рис. 27.2.**

>**Пример 27.2.** Проигрывание аудио с помощью JavaScript
```html
<!DOCTYPE html>
<html>
  <head>
    <title>Playing Audio with JavaScript</title>
    <script src='OSC.js'></script>
  </head>
  <body>
    <audio id='myaudio'>
      <source src='audio.m4a' type='audio/aac'>
      <source src='audio.mp3' type='audio/mp3'>
      <source src='audio.ogg' type='audio/ogg'>
    </audio>

    <button onclick='playaudio()'>Play Audio</button>
    <button onclick='pauseaudio()'>Pause Audio</button>

    <script>
      function playaudio()
      {
        O('myaudio').play()
      }
      function pauseaudio()
      {
        O('myaudio').pause()
      }
    </script>
  </body>
</html>
```
>![[Рис. 27.2. HTML5-аудио можно управлять с помощью JavaScript.jpg]]
>**Рис. 27.2.** HTML5-аудио можно управлять с помощью JavaScript

Проигрыватель будет работать по щелчку на кнопках за счет вызова метода **`play`** или **`pause`** элемента **`myaudio`**.


## Элемент **`<video>`**
---

Проигрывание видео в HTML5 очень похоже на проигрывание аудио. Нужно просто воспользоваться тегом **`<video>`** и предоставить элементы **`<source>`** для предлагаемого вами медиа. В **примере 27.3** показано, как это делается с тремя различными типами видеокодеков (**рис. 27.3**).

>![[Рис. 27.3. Проигрывание HTML5-видео.jpg]]
>**Рис. 27.3.** Проигрывание HTML5-видео
>
>**Пример 27.3.** Проигрывание HTML5-видео
```html
<!DOCTYPE html>
<html>
  <head>
    <title>HTML5 Video</title>
  </head>
  <body>
    <video width='560' height='320' controls>
      <source src='movie.mp4'  type='video/mp4'>
      <source src='movie.webm' type='video/webm'>
      <source src='movie.ogv'  type='video/ogg'>
    </video>
  </body>
</html>
```


### Видеокодеки
---

Как и в случае с аудио, есть несколько доступных видеокодеков с различной поддержкой среди нескольких браузеров. Эти кодеки поступают в разных контейнерах.

- **[[MP4|MP4]]** — лицензированный стандартный формат мультимедийного контейнера, определяемый как часть MPEG-4. MIME-типом является video/mp4.
- **[[Ogg]]** — бесплатный открытый формат контейнера, поддерживаемый Xiph. Org Foundation. Создатели формата **Ogg** утверждают, что он не ограничен патентами на ПО. MIME-типом является **`video/ogg`**.
- **[[WebM]]** — аудио- и видеоформат, предназначенный для предоставления свободного от выплаты роялти открытого формата сжатия видео для использования с видео в HTML5. MIME-типом является **`video/webm`**.

Затем они могут содержать один из следующих видеокодеков.

- *H.264&H.265* — запатентованный видеокодек с правами собственности, проигрывание с применением которого для конечного пользователя бесплатно, но для всех частей процессов кодирования и передачи может потребовать выплаты роялти. H.265 поддерживает почти вдвое большее сжатие, чем H.264, при одинаковом качестве выходного сигнала.
- *Theora* — видеокодек, свободный от патентных обязательств и от выплаты роялти на всех уровнях кодирования передачи и проигрывания.
- *VP8* — этот видеокодек похож на Theora, но является собственностью компании Google, опубликовавшей его в качестве открытого кода и освободившей от выплат роялти.
- *VP9* — предоставляет те же преимущества, что и VP8, но более эффективен и использует половину скорости потока данных.

В настоящее время вы можете быть уверены, что практически все современные браузеры поддерживают все эти видеокодеки, за исключением того, что Theora **`video/ogg`** не поддерживается на iOS, а macOS в версиях ранее 10.11 требует Xiph QuickTime. Поэтому можете воздержаться от использования Ogg, если iOS является одной из ваших целевых платформ (что обычно и происходит), так как можно безопасно полагаться на MP4 или WebM на всех платформах и на время забыть о других форматах. Однако в **примере 27.3** я показал, как добавить все три основных типа видео, если хочется, поскольку браузер затем сам выберет предпочтительный формат.

Элемент **`<video>`** и сопровождающий его тег **`<source>`** поддерживают следующие атрибуты:

- **`autoplay`** — заставляет видео запускаться на проигрывание сразу по готовности;
- **`controls`** — заставляет вывести панель управления;
- **`height`** — указывает высоту, с которой нужно показывать видео;
- **`loop`** — устанавливает видео на бесконечное проигрывание;
- **`muted`** — выключает звуковое сопровождение;
- **`poster`** — позволяет выбрать изображение, показываемое при проигрывании видео;
- **`preload`** — заставляет видео приступить к загрузке даже до того, как пользователь выберет команду Play (Воспроизвести);
- **`src`** — указывает исходное местоположение видеофайла;
- **`type`** — указывает кодек, используемый для создания видео;
- **`width`** — указывает ширину, с которой нужно показывать видео.

Если нужно управлять проигрыванием видео из JavaScript, это можно сделать с помощью кода, подобного показанному в **примере 27.4** (с необходимым дополнительным кодом, выделенным полужирным шрифтом). Результат работы кода продемонстрирован на **рис. 27.4**.

>**Пример 27.4.** Управление проигрыванием видео из JavaScript
```html
<!DOCTYPE html>
<html>
  <head>
    <title>Playing Video with JavaScript</title>
    <script src='OSC.js'></script>
  </head>
  <body>
    <video id='myvideo' width='560' height='320'>
      <source src='movie.mp4'  type='video/mp4'>
      <source src='movie.webm' type='video/webm'>
      <source src='movie.ogv'  type='video/ogg'>
    </video><br>

    <button onclick='playvideo()'>Play Video</button>
    <button onclick='pausevideo()'>Pause Video</button>

    <script>
      function playvideo()
      {
        O('myvideo').play()
      }
      function pausevideo()
      {
        O('myvideo').pause()
      }
    </script>
  </body>
</html>
```

Этот код похож на тот, который использовался для управления проигрыванием аудио из JavaScript. Для проигрывания видео и установки его на паузу нужно просто вызвать метод play и (или) метод pause объекта **`myvideo`**.

Используя информацию, представленную в данной главе, вы сможете встроить любое нужное аудио и видео почти для всех браузеров и платформ, не переживая о том, могут или не могут пользователи их проиграть.

>![[Рис. 27.4. Для управления видео был использован JavaScript.jpg]]
>**Рис. 27.4.** Для управления видео был использован JavaScript

Из [[Другие свойства HTML5]] вы узнаете, как использовать некоторые другие свойства HTML5, включая геолокацию и локальное хранилище.


---