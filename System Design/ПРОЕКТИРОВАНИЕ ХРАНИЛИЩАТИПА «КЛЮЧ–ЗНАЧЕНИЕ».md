---
title: ПРОЕКТИРОВАНИЕ ХРАНИЛИЩАТИПА «КЛЮЧ–ЗНАЧЕНИЕ»
date of creation: 2025-06-17T10:30:00
tags:
  - NoSQL
  - Developing
  - Backend
  - IT
  - IT/Developing
  - SystemDesign
  - Architecture
read status: true
completion status: true
aliases:
  - Проектирование хранилища типа ключ-значение
---
# ПРОЕКТИРОВАНИЕ ХРАНИЛИЩАТИПА «КЛЮЧ–ЗНАЧЕНИЕ»
---

**Хранилище типа «ключ–значение»** — это [[NoSQL|нереляционная база данных]].

В паре «ключ–значение» ключ должен быть уникальным, а соответствующее значение может быть получено через ключ. Ключами могут выступать как обычный текст, так и хешированные значения. Короткие ключи обеспечивают лучшую производительность. Как они выглядят? Вот несколько примеров:

- ключ в виде обычного текста: `last_logged_in_at`;
- хешированный ключ: `253DDEC4`.

Значение в паре может быть строкой, списком, объектом и т. д. В таких хранилищах, как [[Amazon Dynamo]], [[Memcached]], [[Redis]] и т. д., значения обычно считают непрозрачными объектами.

==Вот фрагмент данных из хранилища типа «ключ–значение»:==

| ключ | значение |
| ---- | -------- |
| 122  | erik     |
| 125  | jannet   |
| 132  | nickolas |
	

В этой заметки предложено спроектировать хранилище типа ключ-значения с поддержкой следующих операции.

- **`put`(ключ, значение)** // вставить «значение», связанное с «ключом»;
- **`get`(ключ**) // получить «значение», связанное с «ключом».

Идеальной архитектуры не существует. Каждое решение подразумевает определенные компромиссы между чтением, записью и расходом памяти. В этом примере будем смотреть на следующие характеристики при проектировании:

- малый размер пар «ключ–значение»: меньше 10 Кб;
- возможность хранения объемных данных;
- [[Высокая доступность]] — система должна быстро отвечать даже во время сбоев;
- хорошая [[Мастштабируемость|масштабируемость]] — система должна масштабироваться для поддержки объемных наборов данных;
- [[Автоматическое масштабирование]] — серверы должны автоматически добавляться/удаляться в зависимости от трафика;
- [[Регулируемая согласованность]];
- низкая [[Латентность|латентность]].


## ХРАНИЛИЩЕ ТИПА «КЛЮЧ–ЗНАЧЕНИЕ» НА ОДНОМ СЕРВЕРЕ
---

==Разработать хранилище типа «ключ–значение», находящееся в пределах одного сервера, довольно просто. Очевидное решение заключается в хранении пар в хеш-таблице, содержимое которой находится в памяти.== Достать данные оттуда довольно легко, но их объем ограничен из-за лимита памяти. С этой проблемой можно бороться двумя путями:

- сжимать данные;
- хранить в памяти только часто используемые данные, а все остальное записывать на диск.

Но даже с этими мерами отдельно взятый сервер может очень быстро исчерпать свои ресурсы. ==Для поддержки крупных данных хранилище типа «ключ–значение» должно быть [[#РАСПРЕДЕЛЕННОЕ ХРАНИЛИЩЕ ТИПА «КЛЮЧ–ЗНАЧЕНИЕ»|распределенным]]==.


## РАСПРЕДЕЛЕННОЕ ХРАНИЛИЩЕ ТИПА «КЛЮЧ–ЗНАЧЕНИЕ»
---

Распределенное хранилище типа «ключ–значение» иногда называют распределенной хеш-таблицей. Оно распределяет пары «ключ–значение» между множеством серверов. При проектировании распределенной системы необходимо понимать теорему [[System Design/Теорема CAP]] (Consistency, Availability, Partition Tolerance — «согласованность, доступность, устойчивость к секционированию»).