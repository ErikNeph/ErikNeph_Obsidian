---
title: DML — язык управления данными
read status: true
completion status: true
---

Все операторы SQL, которые вы уже изучили, использовались для извлечения информации из базы данных или создания производных данных на основе имеющихся значений. Эта глава познакомит вас с ==***языком управления данными***== (*DML*) и с операторами SQL, которые используются для изменения данных, хранящихся в таблицах базы данных.

**ВНИМАНИЕ**
**С этими командами лучше попрактиковаться в «песочнице», например на нашей учебной базе данных. Использование DML в рабочей базе с реальными данными может привести к фатальным последствиям.**


## Чем различаются анализ данных и управление базами данных
---

До сих пор мы говорили о том, что основная цель SQL-запросов — извлечение существующих данных из базы данных и преобразование их в полезную информацию (на примере компании sTunes). Но, как мы упоминали во введении, SQL выполняет гораздо более сложные задачи, чем просто превращение данных в значимую информацию. Существуют такие специалисты, как разработчики баз данных и администраторы баз данных, контролирующие рост, улучшение и управление базой данных компании. Функции этих специалистов различаются в зависимости от компании и реализации базы данных. Даже опытные пользователи SQL расходятся во мнениях о том, является ли язык DML (Data Manipulation Language — язык управления данными) отдельной областью изучения или его следует изучать совместно с операторами SQL, предназначенными только для извлечения информации.

Данными в РСУБД можно управлять с помощью следующих DML-команд: `INSERT`, `UPDATE` и `DELETE`. Как следует из названий, эти команды* могут использоваться для добавления, изменения и удаления данных из таблиц в базе данных. Для нашей базы sTunes мы продемонстрируем, как выполнить задание от руководства компании на добавление новых исполнителей к нашей музыкальной базе, добавление новых записей, а затем их удаление.

* INSERT, UPDATE и DELETE могут называться как командами, так и операторами.


## Добавление данных в БД
---

Команда INSERT используется для вставки новых записей в таблицу. Существует несколько способов написать команду `INSERT`. Один из способов — использовать `INSERT` `INTO` и указать необходимое поле. Допустим, компания sTunes расширяет свой ассортимент и хочет, чтобы мы добавили в таблицу artists еще нескольких исполнителей.

Рассмотрим, как добавить новую запись в таблицу `artists` с помощью команды `INSERT`.

`INSERT INTO`
`artists (Name)`
`VALUES ('Bob Marley')`

Эта вставка состоит из трех элементов: таблицы, поля и значения. Таблица `artists` указана после команды `INSERT` `INTO`, где названа таблица, которую необходимо изменить. За ним следует имя поля, заключенное в круглые скобки (). В данном случае мы хотим добавить нового исполнителя, добавив его имя в поле Name. Затем следует ключевое слово `VALUES`, после которого в круглых скобках указано значение, которое необходимо добавить в таблицу `artists`. В нашем примере это Bob Marley. Bob Marley — это текстовое значение, поэтому оно заключено в одинарные кавычки.

**ПРИМЕЧАНИЕ**
**В таблице artists имеется второй столбец — `ArtistId`. Его не надо указывать в команде `INSERT`, так как это столбец с автоматическим приращением. Это означает, что в столбце автоматически создается новый номер для новых добавляемых записей.**

Еще один способ добавить значения в таблицу — перечислить значения последовательно по имени поля. В этом случае не нужно указывать столбцы, в которых должны храниться данные. Однако в этом случае при написании команды `INSERT` необходимо быть внимательным, чтобы гарантировать, что порядок, в котором данные указываются в команде `INSERT`, совпадает с порядком перечисления полей в таблице.

Рассмотрим пример добавления новой записи в таблицу employees.

`INSERT INTO`
`employees`
`VALUES ('9', 'Martin', 'Ricky', 'Sales Support Agent', '2', '1975-02-07',`
`'2018-01-05', '123 Houston St', 'New York', 'NY', 'United States', '11201', '(347) 525-8588', '', 'rmartin@gmail.com')`

Очень важно проследить, чтобы порядок, в котором данные указываются в команде `INSERT`, соответствовал порядку следования полей в целевой таблице. Поэтому рекомендуется сначала изучить целевую таблицу, и обратите внимание на порядок, в котором появляются поля.

На вкладке Database Structure (Структура базы данных) мы видим структуру таблицы employees. При использовании команды `INSERT` поля от `EmployeeId` до `Email` должны быть указаны именно в таком порядке.

**ВНИМАНИЕ**
**При добавлении новых записей, в которых для какого-либо поля не существует значения, вам необходимо добавить пару пустых кавычек ' ' для этого несуществующего значения. В приведенном выше примере мы пропустили номер факса при помощи пары пустых кавычек в таблице employees.**


## Обновление данных и ключевое слово SET
---

Команда `UPDATE` используется для изменения существующих данных в таблице. Как правило, команда `UPDATE` применяется с условием `WHERE`. Условие `WHERE` необходимо для указания строк, которые будут обновлены. Без условия `WHERE` оператор `UPDATE` обновит все содержащиеся в таблице строки.

Следующий оператор обновляет запись о сотруднике, которую мы добавили в предыдущем разделе:

```sql
UPDATE
    employees
SET PostalCode = '11202'
WHERE
	EmployeeId = 9
```

Анализируя предыдущий синтаксис, мы видим, что таблица employees указывается после ключевого слова `UPDATE`. Затем следует ключевое слово `SET`, и именно здесь указан столбец в таблице employees, который необходимо обновить. В нашем примере это поле `PostalCode`. За ним следует знак равенства = и новое значение, которое заменит старое значение. В нашем примере это значение '`11202`' (заключено в одинарные кавычки, так как почтовый индекс является строковым значением). После ключевого слова SET следует условие WHERE, которое позволяет нам точно указать, какую запись о сотруднике мы собираемся обновить. Запись `EmployeeId=9` означает, что обновляется только эта запись и никакая другая.

**ВНИМАНИЕ**
**Особое внимание следует уделить добавлению условия WHERE в UPDATE. Если условие WHERE не включено и в нем не указаны необходимые для изменения записи, вы можете обновить записи, которые вы не собирались обновлять, что может привести к серьезным проблемам.**


## Удаление данных

Оператор `DELETE` используется для удаления существующих записей в таблице. Этот оператор, как и `UPDATE`, обычно используется с условием `WHERE`. Если условие `WHERE` отсутствует, оператор `DELETE` удалит все строки в таблице.

**ПРИМЕЧАНИЕ**
**Как и в случае с `UPDATE`, не стремитесь сразу выполнять оператор DELETE, сначала напишите оператор `SELECT`, `используя` те же таблицы и условие `WHERE`. Таким образом вы сможете предварительно проанализировать, что вы собираетесь удалить. Как только оператор `SELECT` вернет ожидаемые записи, вы можете выполнить оператор `DELETE`.**

Сначала напишем оператор SELECT, чтобы проверить данные, которые мы собираемся удалить.

```sql
SELECT
	*
FROM
	employees
```


Рассмотрим пример удаления записи, обновленной в предыдущем разделе.

```sql
DELETE FROM
	employees
WHERE
	EmployeeId = 9
```


Синтаксис оператора `DELETE` начинается с двух ключевых слов, `DELETE` `FROM`, за которыми следует имя таблицы, откуда мы собираемся удалить запись. В нашем примере мы удаляем запись из таблицы employees. После имени таблицы следует условие `WHERE`, которое позволяет нам точно указать, какую запись о сотруднике необходимо удалить. Запись `EmployeeId=9` означает, что будет удалена только эта запись и никакая другая.

**ВНИМАНИЕ**
**Особое внимание следует уделить добавлению условия `WHERE` к оператору `DELETE`. Если условие `WHERE` не включено и в нем не указаны необходимые для удаления записи, вы можете удалить не те записи, что вызовет серьезные проблемы.**

